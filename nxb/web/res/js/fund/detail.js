define("fund/detail",["libs/pie","libs/template"],function(e,t,n){var a=e("libs/pie"),r=e("libs/template");r.helper("numToPercent",function(e){return(100*e).toFixed(2)+"%"}),r.helper("dateFormate",function(e){var t=e.substring(0,10).split("-");return t[0]+"年"+t[1]+"月"+t[2]+"日"}),r.helper("getNowDate",function(){var e=new Date,t="yyyy-MM-dd h:m:s",n={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),"S+":e.getMilliseconds()};/(y+)/i.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var a in n)new RegExp("("+a+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?n[a]:("00"+n[a]).substr((""+n[a]).length)));return t});var i={bindEvent:function(){$("body").delegate(".js-tap",$.Func.TAP,function(e){var t=$(this).data("handler");i[t]&&i[t].call(this)})},holdingList:function(e){var t=this,n={jsonrpc:"2.0",method:"Fund.FundHoldStockNoCategory",id:54321,params:{Fundid:e}};$.Func.ajax(n,function(n){var a=n.result,i=0,o=[];$.each(a.data,function(e,t){i+=t.percent,o.push({volume:t.volume,percent:t.percent,label:t.stockname})}),o.push({percent:1-i,label:"现金"});var d=r("holding-template",a);$("#holdingList").html(d),t.renderPage(e,i,o)})},operatingList:function(e){var t={jsonrpc:"2.0",method:"Fund.FundOperateRecord",id:54321,params:{Fundid:e,Count:2}};$.Func.ajax(t,function(t){var n=t.result;n.fundid=e;var a=r("operating-template",n);$("#operatingList").html(a)})},renderPage:function(e,t,n){var a=this,i={jsonrpc:"2.0",method:"Fund.FundInfo",id:54321,params:{fundid:e}};$.Func.ajax(i,function(e){var i=e.result;i.data[0].per=t;var o=r("info-template",i.data[0]);$("#info").html(o),a.renderPie(n)})},renderPie:function(e){new a({selector:"#canvas_fan",data:e})},init:function(){var e=$.Func.getParam("fundid");this.holdingList(e),this.operatingList(e)}};n.exports=i});